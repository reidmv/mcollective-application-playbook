---
- name: 'Perform actions on the master'
  filter:
    identity: 'master'
  tasks:
    - name: 'Do a thing'
      agent: service
      action: status
      parameters:
        service: sshd
    - name: 'Do another thing'
      agent: service
      action: status
      parameters:
        service: sshd
- name: 'Perform actions on filtered systems'
  filter:
    class:    'profile::application'
    fact:     'osfamily=RedHat'
    compound: 'osfamily=RedHat and profile::application'
  tasks:
    - name: 'Do a thing'
      agent: service
      action: status
      parameters:
        service: sshd
      on_failure: break
    - name: 'Do another thing'
      agent: service
      action: status
      parameters:
        service: sshd
